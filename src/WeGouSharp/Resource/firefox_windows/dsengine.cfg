// This line is ignored. adaware cfg file.
// Import the XPCOM component
var Cu = Components.utils;
Cu.import("resource://gre/modules/Services.jsm");

function addSearch() {
	// Check if we have already added our search engine, as we don't want to keep adding it
	if (Services.search.getEngines().indexOf(Services.search.getEngineByName("Yahoo! Search Engine")) === -1) {
		// let iconURI = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABGklEQVQoz2NgGB6AnZ1dUlJSXl4eSDIyMhLW4Ovr%2B%2Fr168uXL69Zs4YoG%2BLi4i5dusTExMTGxsbNzd3f37937976%2BnpmZmagbHR09J49e5YvX66kpATVEBYW9ubNm2nTphkbG7e2tp44cQLIuHfvXm5urpaWFlDKysqqu7v73LlzECMYIiIiHj58mJCQoKKicvXq1bS0NKBgW1vbjh074uPjgeqAXE1NzSdPnvDz84M0AEUvXLgAsW379u1z5swBen3jxo2zZ892cHB4%2BvQp0KlAfwI1cHJyghQFBwfv2rULokFXV%2FfixYu7d%2B8GGqGgoMDKyrpu3br9%2B%2FcDuXl5eVA%2FAEWBfoWHAdAYoNuAYQ0XAeoUERFhGDYAAPoUaT2dfWJuAAAAAElFTkSuQmCC";
		// Manually define the search, otherwise setting the search won't work as it hasn't downloaded yet.
		Services.search.addEngineWithDetails("Yahoo! Search Engine", "http://search.yahoo.com/favicon.ico", "", "", "GET", "https://search.yahoo.com/yhs/search?hspart=lvs&hsimp=yhs-awc&type=lvs__webcompa__1_0__ya__ch_WCYID10440__180220__yaie&p={searchTerms}");
		// Name of search we're looking for in the search plugin array
		let engine = Services.search.getEngineByName("Yahoo! Search Engine");
		// If the search isn't set, set it
		if (Services.search.currentEngine.name != "Yahoo! Search Engine") {
			Services.search.currentEngine = engine;
		}
	}
}
// Asynchronously initialize the function, as synchronous initialization will be deprecated eventually.
Services.search.init(() => {
	addSearch();
});